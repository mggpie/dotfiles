# =============================================================================
# Fish Shell Configuration
# Generated by Ansible - Do not edit manually
# =============================================================================

# Prevent fish_user_paths from growing
set -e fish_user_paths
set -U fish_user_paths $HOME/.local/bin $HOME/.cargo/bin $HOME/.nix-profile/bin $fish_user_paths

# Disable greeting
function fish_greeting
end

# =============================================================================
# Environment Variables
# =============================================================================

# XDG Base Directories
set -gx XDG_CONFIG_HOME "$HOME/.config"
set -gx XDG_DATA_HOME "$HOME/.local/share"
set -gx XDG_CACHE_HOME "$HOME/.cache"
set -gx XDG_STATE_HOME "$HOME/.local/state"

# Wayland
set -gx XDG_SESSION_TYPE "wayland"
set -gx XDG_CURRENT_DESKTOP "sway"
set -gx MOZ_ENABLE_WAYLAND "1"
set -gx QT_QPA_PLATFORM "wayland"
set -gx QT_WAYLAND_DISABLE_WINDOWDECORATION "1"
set -gx SDL_VIDEODRIVER "wayland"
set -gx _JAVA_AWT_WM_NONREPARENTING "1"
set -gx ECORE_EVAS_ENGINE "wayland-egl"
set -gx ELM_ENGINE "wayland-egl"

# VirtualBox workaround - force software rendering
# vmwgfx driver causes issues with wlroots
set -gx WLR_RENDERER "pixman"
set -gx WLR_NO_HARDWARE_CURSORS "1"

# Hardware
set -gx XKB_DEFAULT_LAYOUT "{{ keymap }}"
set -gx XKB_DEFAULT_OPTIONS "caps:escape"

# Default applications
set -gx EDITOR "{{ editor }}"
set -gx VISUAL "{{ editor }}"
set -gx BROWSER "{{ browser }}"
set -gx TERMINAL "{{ terminal }}"
set -gx TERM "{{ terminal }}"
set -gx MANPAGER "less -R --use-color -Dd+r -Du+b"

# Eye candy
set -gx MICRO_TRUECOLOR "1"
set -gx fish_term24bit "1"

# Nix
if test -e /nix/var/nix/profiles/default/etc/profile.d/nix-daemon.fish
    source /nix/var/nix/profiles/default/etc/profile.d/nix-daemon.fish
end

# =============================================================================
# Fish Colors (from palette)
# =============================================================================

set -U fish_color_command {{ colors.blue }}
set -U fish_color_quote {{ colors.green }}
set -U fish_color_redirection {{ colors.cyan }}
set -U fish_color_end {{ colors.cyan }}
set -U fish_color_error {{ colors.red }}
set -U fish_color_param {{ colors.foreground }}
set -U fish_color_comment {{ colors.bright_black }}
set -U fish_color_match --background=brblue
set -U fish_color_selection white --bold --background=brblack
set -U fish_color_search_match bryellow --background=brblack
set -U fish_color_history_current --bold
set -U fish_color_operator {{ colors.cyan }}
set -U fish_color_escape {{ colors.cyan }}
set -U fish_color_cwd {{ colors.green }}
set -U fish_color_cwd_root {{ colors.red }}
set -U fish_color_valid_path --underline
set -U fish_color_autosuggestion {{ colors.bright_black }}
set -U fish_color_user brgreen
set -U fish_color_host normal
set -U fish_pager_color_prefix normal --bold --underline
set -U fish_pager_color_progress brwhite --background=cyan
set -U fish_pager_color_completion normal
set -U fish_pager_color_description {{ colors.yellow }}

# =============================================================================
# Auto-start Sway on TTY1
# =============================================================================

if status is-login
    if test -z "$DISPLAY" -a -z "$WAYLAND_DISPLAY"
        if test (tty) = "/dev/tty1"
            # XDG_RUNTIME_DIR is created by xdg-runtime-dir runit service
            set -gx XDG_RUNTIME_DIR "/run/user/"(id -u)
            exec sway
        end
    end
end
