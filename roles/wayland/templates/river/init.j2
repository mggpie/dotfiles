#!/bin/sh
# =============================================================================
# River Window Manager Configuration
# Generated by Ansible - Do not edit manually
# =============================================================================

mod="Mod4"

# =============================================================================
# Key Bindings
# =============================================================================

# Application launcher (bemenu) - Super+D
riverctl map normal $mod D spawn 'bemenu-run -p "run:" --fn "{{ fonts['mono'] }} {{ fonts['size']['ui'] }}" -H 24 --tb "#{{ colors['background'] }}" --tf "#{{ colors['foreground'] }}" --fb "#{{ colors['background'] }}" --ff "#{{ colors['foreground'] }}" --nb "#{{ colors['background'] }}" --nf "#{{ colors['foreground'] }}" --hb "#{{ colors['blue'] }}" --hf "#{{ colors['background'] }}"'

# Terminal - Super+Shift+Enter
riverctl map normal $mod+Shift Return spawn footclient

# Close window - Super+Shift+Q
riverctl map normal $mod+Shift Q close

# Screenshot - Print key
riverctl map normal None Print spawn 'screenshot.sh area'
riverctl map normal Shift Print spawn 'screenshot.sh full'

# Lock screen - Super+L (when not moving windows)
# riverctl map normal $mod+Shift L spawn 'swaylock -f -c 000000'

# =============================================================================
# Window Navigation (Vim-like: I/K for up/down, J/L for resize)
# =============================================================================

# Focus next/previous window
riverctl map normal $mod K focus-view next
riverctl map normal $mod I focus-view previous

# Resize main area
riverctl map normal $mod J send-layout-cmd rivertile "main-ratio -0.05"
riverctl map normal $mod L send-layout-cmd rivertile "main-ratio +0.05"

# Swap windows
riverctl map normal $mod+Shift K swap next
riverctl map normal $mod+Shift I swap previous

# Change main count
riverctl map normal $mod+Shift J send-layout-cmd rivertile "main-count +1"
riverctl map normal $mod+Shift L send-layout-cmd rivertile "main-count -1"

# Move floating windows
riverctl map normal $mod+Mod1 J move left 100
riverctl map normal $mod+Mod1 K move down 100
riverctl map normal $mod+Mod1 I move up 100
riverctl map normal $mod+Mod1 L move right 100

# Resize floating windows
riverctl map normal $mod+Mod1+Shift J resize horizontal -100
riverctl map normal $mod+Mod1+Shift K resize vertical 100
riverctl map normal $mod+Mod1+Shift I resize vertical -100
riverctl map normal $mod+Mod1+Shift L resize horizontal 100

# =============================================================================
# Output (Monitor) Navigation
# =============================================================================

riverctl map normal $mod Period focus-output next
riverctl map normal $mod Comma focus-output previous
riverctl map normal $mod+Shift Period send-to-output next
riverctl map normal $mod+Shift Comma send-to-output previous

# Bump focused view to top
riverctl map normal $mod Return zoom

# =============================================================================
# Mouse Bindings
# =============================================================================

riverctl map-pointer normal $mod BTN_LEFT move-view
riverctl map-pointer normal $mod BTN_RIGHT resize-view

# =============================================================================
# Tags (Workspaces) 1-9
# =============================================================================

for i in $(seq 1 9); do
    tags=$((1 << ($i - 1)))
    
    # Super+[1-9] - focus tag
    riverctl map normal $mod $i set-focused-tags $tags
    
    # Super+Shift+[1-9] - move window to tag
    riverctl map normal $mod+Shift $i set-view-tags $tags
    
    # Super+Ctrl+[1-9] - toggle tag focus
    riverctl map normal $mod+Control $i toggle-focused-tags $tags
    
    # Super+Shift+Ctrl+[1-9] - toggle tag on window
    riverctl map normal $mod+Shift+Control $i toggle-view-tags $tags
done

# Super+0 - view all tags
all_tags=$(((1 << 32) - 1))
riverctl map normal $mod 0 set-focused-tags $all_tags
riverctl map normal $mod+Shift 0 set-view-tags $all_tags

# =============================================================================
# Layout Controls
# =============================================================================

# Toggle floating
riverctl map normal $mod Space toggle-float

# Toggle fullscreen
riverctl map normal $mod F toggle-fullscreen

# Layout orientation
riverctl map normal $mod Up    send-layout-cmd rivertile "main-location top"
riverctl map normal $mod Right send-layout-cmd rivertile "main-location right"
riverctl map normal $mod Down  send-layout-cmd rivertile "main-location bottom"
riverctl map normal $mod Left  send-layout-cmd rivertile "main-location left"

# =============================================================================
# Media Keys
# =============================================================================

for mode in normal locked; do
    # Volume
    riverctl map $mode None XF86AudioRaiseVolume spawn 'pamixer -i 5'
    riverctl map $mode None XF86AudioLowerVolume spawn 'pamixer -d 5'
    riverctl map $mode None XF86AudioMute spawn 'pamixer --toggle-mute'
    
    # Media playback
    riverctl map $mode None XF86AudioPlay spawn 'playerctl play-pause'
    riverctl map $mode None XF86AudioPrev spawn 'playerctl previous'
    riverctl map $mode None XF86AudioNext spawn 'playerctl next'
    
    # Brightness (if applicable)
    riverctl map $mode None XF86MonBrightnessUp spawn 'light -A 5'
    riverctl map $mode None XF86MonBrightnessDown spawn 'light -U 5'
done

# =============================================================================
# Appearance
# =============================================================================

riverctl background-color 0x{{ colors['background'] }}
riverctl border-color-focused 0x{{ theme.border_focused }}
riverctl border-color-unfocused 0x{{ theme.border_unfocused }}
riverctl border-width {{ theme.border_width }}

# =============================================================================
# Behavior
# =============================================================================

riverctl focus-follows-cursor normal
riverctl set-cursor-warp disabled
riverctl set-repeat 50 300
riverctl hide-cursor when-typing enabled

# =============================================================================
# Window Rules
# =============================================================================

riverctl float-filter-add app-id float
riverctl float-filter-add app-id imv
riverctl float-filter-add app-id pavucontrol
riverctl float-filter-add app-id blueman-manager
riverctl float-filter-add title "popup"
riverctl float-filter-add title "About"
riverctl float-filter-add title "Preferences"

# CSD for specific apps
riverctl csd-filter-add app-id "luakit"
riverctl csd-filter-add app-id "firefox"

# =============================================================================
# Autostart
# =============================================================================

# Terminal server
riverctl spawn "foot --server"

# Status bar
riverctl spawn "waybar"

# Output manager
riverctl spawn "kanshi"

# Clipboard manager
riverctl spawn "wl-paste --watch cliphist store" 2>/dev/null || true

# =============================================================================
# Default Layout
# =============================================================================

riverctl default-layout rivertile
exec rivertile -view-padding 2 -outer-padding 2
