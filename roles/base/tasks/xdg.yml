---
# =============================================================================
# XDG Base Directories Setup
# =============================================================================

- name: Install xdg-user-dirs
  ansible.builtin.command:
    cmd: xbps-install -Sy xdg-user-dirs xdg-utils
  changed_when: true

- name: Create XDG user directories config
  ansible.builtin.copy:
    content: |
      # XDG user directories - standard English names
      # These are used by many applications
      XDG_DESKTOP_DIR="$HOME/Desktop"
      XDG_DOWNLOAD_DIR="$HOME/Downloads"
      XDG_TEMPLATES_DIR="$HOME/Templates"
      XDG_PUBLICSHARE_DIR="$HOME/Public"
      XDG_DOCUMENTS_DIR="$HOME/Documents"
      XDG_MUSIC_DIR="$HOME/Music"
      XDG_PICTURES_DIR="$HOME/Pictures"
      XDG_VIDEOS_DIR="$HOME/Videos"
    dest: "{{ user_home }}/.config/user-dirs.dirs"
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: '0644'

- name: Prevent xdg-user-dirs from overwriting config
  ansible.builtin.copy:
    content: "enabled=False"
    dest: "{{ user_home }}/.config/user-dirs.conf"
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: '0644'

- name: Create XDG directories
  ansible.builtin.file:
    path: "{{ user_home }}/{{ item }}"
    state: directory
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: '0755'
  loop:
    - Desktop
    - Downloads
    - Templates
    - Public
    - Documents
    - Music
    - Pictures
    - Videos
